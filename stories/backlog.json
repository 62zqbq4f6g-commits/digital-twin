{
  "_meta": {
    "project": "Digital Twin PWA",
    "total_stories": 14,
    "estimated_total_time": "8 hours",
    "design": "Minimalist black/white Soho NYC aesthetic",
    "important": "Read CLAUDE.md for all specs, templates, and code examples"
  },
  "stories": [
    {
      "id": "DT-001",
      "title": "PWA foundation",
      "status": "done",
      "estimated_minutes": 30,
      "description": "Create basic PWA structure with HTML, manifest, and service worker shell.",
      "acceptance_criteria": [
        "index.html exists with proper HTML5 doctype and structure",
        "manifest.json exists with name='Digital Twin', short_name='DT'",
        "manifest.json has theme_color=#000000, background_color=#FFFFFF",
        "manifest.json references icon-192.png and icon-512.png",
        "sw.js exists with basic install and fetch event handlers",
        "index.html links to manifest.json via <link rel='manifest'>",
        "index.html registers service worker in script tag",
        "index.html has viewport meta tag for mobile",
        "Page loads without console errors"
      ],
      "not_done_if": [
        "Missing manifest.json link",
        "Service worker not registered",
        "Console errors on load",
        "Missing viewport meta tag"
      ],
      "verification": "cat index.html && cat manifest.json && cat sw.js && echo 'Open in browser, check no console errors'",
      "files_to_create": ["index.html", "manifest.json", "sw.js"],
      "dependencies": []
    },
    {
      "id": "DT-002",
      "title": "Design system CSS",
      "status": "done",
      "estimated_minutes": 30,
      "description": "Implement complete CSS design system from CLAUDE.md. Black/white only.",
      "acceptance_criteria": [
        "css/styles.css exists",
        "All CSS variables from CLAUDE.md section 4 are defined in :root",
        "Colors: --color-black, --color-white, --color-gray-50/100/200/400/600",
        "Typography: --font-sans, --font-mono, --text-title/heading/body/caption/micro",
        "Spacing: --space-xs through --space-3xl",
        "Borders: --radius-sm/md/lg/xl/full, --border-thin/medium",
        "Transitions: --transition-fast/normal/slow",
        "Base styles for body (font-family, background, color, margin:0)",
        "Box-sizing border-box on all elements",
        "index.html links to css/styles.css",
        "NO colors used other than black, white, grays"
      ],
      "not_done_if": [
        "Missing any CSS variable from CLAUDE.md",
        "Uses colors other than black/white/gray",
        "Not linked in index.html",
        "Missing base body styles"
      ],
      "verification": "cat css/styles.css | head -80 && grep -c 'color-' css/styles.css",
      "files_to_create": ["css/styles.css"],
      "dependencies": ["DT-001"]
    },
    {
      "id": "DT-003",
      "title": "IndexedDB database layer",
      "status": "done",
      "estimated_minutes": 30,
      "description": "Create IndexedDB wrapper following schema from CLAUDE.md section 6.",
      "acceptance_criteria": [
        "js/db.js exists",
        "Creates database named 'digital-twin' version 1",
        "Creates object store 'notes' with keyPath 'id'",
        "Creates indexes: by_date, by_category, by_created",
        "Has initDB() function returning Promise",
        "Has saveNote(note) function that auto-generates ID if missing",
        "Has getAllNotes() function returning array sorted by created_at desc",
        "Has getNotesByCategory(category) function",
        "Has getNoteById(id) function returning single note or null",
        "Has deleteNote(id) function",
        "Has exportAllNotes() function returning JSON string",
        "ID format: dt_YYYYMMDD_HHMMSS_xxx (use generateId function from CLAUDE.md)",
        "Automatically adds timestamps.created_at if missing"
      ],
      "not_done_if": [
        "Wrong database name",
        "Missing any CRUD function",
        "ID format doesn't match spec",
        "Missing indexes",
        "saveNote doesn't return the saved note with ID"
      ],
      "verification": "cat js/db.js && grep -c 'function' js/db.js",
      "files_to_create": ["js/db.js"],
      "dependencies": ["DT-001"]
    },
    {
      "id": "DT-004",
      "title": "App shell UI",
      "status": "done",
      "estimated_minutes": 45,
      "description": "Create main HTML structure with navigation and three screens.",
      "acceptance_criteria": [
        "index.html has three screen sections: capture, notes, settings",
        "Each screen is a <section> with id='screen-capture', 'screen-notes', 'screen-settings'",
        "Only one screen visible at a time (others have class 'hidden')",
        "Bottom navigation bar fixed at bottom with 3 tabs",
        "Nav tabs: Capture (default/active), Notes, Settings",
        "Header shows 'Digital Twin' title",
        "js/ui.js exists with navigation switching logic",
        "Clicking nav tab shows corresponding screen, hides others",
        "Active nav tab has visual indicator (underline or bold)",
        "All text is black on white background",
        "Uses design system CSS variables",
        "Screens are min-height: 100vh minus nav height",
        "Mobile responsive (works at 375px width)"
      ],
      "not_done_if": [
        "Multiple screens visible at once",
        "Navigation doesn't work",
        "Uses colors other than black/white/gray",
        "Not mobile responsive",
        "Missing any screen section"
      ],
      "verification": "cat index.html | grep -c 'screen-' && cat js/ui.js",
      "files_to_create": ["js/ui.js"],
      "dependencies": ["DT-002"]
    },
    {
      "id": "DT-005",
      "title": "Text input component",
      "status": "done",
      "estimated_minutes": 30,
      "description": "Create text input area on Capture screen with submit.",
      "acceptance_criteria": [
        "Textarea on Capture screen below voice button area",
        "Placeholder text: 'What's on your mind?'",
        "Auto-expanding height (grows with content)",
        "Submit button to the right (arrow icon or 'Send')",
        "Submit on button click",
        "Submit on Enter key (desktop) - Shift+Enter for newline",
        "Clears input after successful submit",
        "Disabled state while processing (grayed out)",
        "Black border, white background, follows design system",
        "Minimum height 48px",
        "onSubmit calls a placeholder processNote function",
        "Shows temporary 'Note saved!' feedback after submit"
      ],
      "not_done_if": [
        "Submit doesn't work",
        "Doesn't clear after submit",
        "No visual feedback on submit",
        "Enter key doesn't submit"
      ],
      "verification": "Test in browser: type text, submit, verify clears and shows feedback",
      "files_to_create": [],
      "dependencies": ["DT-004"]
    },
    {
      "id": "DT-006",
      "title": "Voice input with Web Speech API",
      "status": "backlog",
      "estimated_minutes": 45,
      "description": "Implement voice recording using Web Speech API with visual feedback.",
      "acceptance_criteria": [
        "js/voice.js exists",
        "Large microphone button centered on Capture screen (80x80px circle)",
        "Visual states from CLAUDE.md section 9.1: idle (outline), recording (filled+pulse), processing (dashed+spin)",
        "Requests microphone permission on first tap",
        "Starts SpeechRecognition on tap",
        "Shows real-time transcription below button as user speaks",
        "Stops on second tap",
        "Auto-stops after 10 seconds of silence",
        "Transcription appears in text input area when done",
        "Graceful fallback: shows message if browser doesn't support Web Speech API",
        "Uses continuous=true and interimResults=true",
        "Has startRecording() and stopRecording() functions"
      ],
      "not_done_if": [
        "No visual feedback during recording",
        "Crashes if permission denied",
        "No fallback message for unsupported browsers",
        "Transcription doesn't appear in text area"
      ],
      "verification": "cat js/voice.js && echo 'Test in Chrome with microphone'",
      "files_to_create": ["js/voice.js"],
      "dependencies": ["DT-005"]
    },
    {
      "id": "DT-007",
      "title": "Classifier module",
      "status": "backlog",
      "estimated_minutes": 30,
      "description": "4-category classification using keywords from CLAUDE.md section 5.",
      "acceptance_criteria": [
        "js/classifier.js exists",
        "Has classify(text) function",
        "Returns object: {category, confidence, reasoning}",
        "Categories: 'personal', 'work', 'health', 'ideas' (lowercase)",
        "Uses EXACT keyword lists from CLAUDE.md section 5.2",
        "Counts keyword matches per category",
        "Returns category with highest match count",
        "Confidence = matches/total_matches (0-1)",
        "Default to 'personal' with confidence 0.5 if no matches",
        "Reasoning string explains why (e.g., 'Matched 3 work keywords')",
        "Handles empty string (returns personal, 0.5)",
        "Handles null/undefined input without crashing",
        "Case-insensitive matching"
      ],
      "not_done_if": [
        "Wrong keyword lists",
        "Returns category not in the four allowed",
        "Crashes on empty input",
        "Missing reasoning in output",
        "Case-sensitive matching"
      ],
      "verification": "cat js/classifier.js && echo 'Test: classify(\"meeting with investor\") should return work'",
      "files_to_create": ["js/classifier.js"],
      "dependencies": ["DT-001"]
    },
    {
      "id": "DT-008",
      "title": "Extractor module",
      "status": "backlog",
      "estimated_minutes": 45,
      "description": "Extract metadata following rules from CLAUDE.md section 8.",
      "acceptance_criteria": [
        "js/extractor.js exists",
        "Has extract(text) function",
        "Returns: {title, topics, action_items, sentiment, people}",
        "title: First sentence, max 50 chars, filler words removed, fallback 'Untitled Note'",
        "topics: Array of matched category names (max 5)",
        "action_items: Extracted using ACTION_TRIGGERS from CLAUDE.md 8.2",
        "action_items: Filters out FALSE_POSITIVES",
        "sentiment: 'positive', 'negative', or 'neutral' using words from CLAUDE.md 8.3",
        "people: Capitalized names, filtered COMMON_WORDS from CLAUDE.md 8.4",
        "All arrays can be empty (no crash)",
        "Has cleanText() helper that removes filler words from CLAUDE.md 7.5",
        "Handles empty input gracefully"
      ],
      "not_done_if": [
        "Missing any output field",
        "Crashes on empty input",
        "Title exceeds 50 characters",
        "Includes false positive action items",
        "Filler words remain in title"
      ],
      "verification": "cat js/extractor.js && echo 'Test with sample inputs from CLAUDE.md section 10'",
      "files_to_create": ["js/extractor.js"],
      "dependencies": ["DT-001"]
    },
    {
      "id": "DT-009",
      "title": "Refiner module",
      "status": "backlog",
      "estimated_minutes": 45,
      "description": "Transform raw input into professional output using EXACT templates from CLAUDE.md section 7.",
      "acceptance_criteria": [
        "js/refiner.js exists",
        "Has refine(rawText, classification, extracted) function",
        "Returns: {summary, formatted_output}",
        "summary: 2-3 sentence professional summary, no filler words",
        "formatted_output: Full markdown document matching templates in CLAUDE.md 7.1-7.4",
        "Work template: title, date/time/tz/day, summary, key points, action items, people, footer",
        "Personal template: title, date/time/tz/day, narrative, reminders, footer",
        "Health template: title, date/time/tz/day, check-in, mood, reminders, footer",
        "Ideas template: title, date/time/tz/day, concept, potential, next steps, footer",
        "All templates end with: *Captured by Digital Twin*",
        "Timestamp format: '[Day], [Month] [Date], [Year]' and '[Time] [Timezone]'",
        "Uses Asia/Singapore timezone",
        "Cleans filler words (um, uh, like, so yeah, etc.)",
        "Action items formatted with ‚òê checkbox character",
        "Output is professional enough to copy-paste and share"
      ],
      "not_done_if": [
        "Output contains filler words (um, uh, like)",
        "Wrong template for category",
        "Missing date/time/timezone/day",
        "Missing footer",
        "Not formatted as clean markdown",
        "Would require manual editing before sharing"
      ],
      "verification": "cat js/refiner.js && echo 'Compare output to examples in CLAUDE.md section 10'",
      "files_to_create": ["js/refiner.js"],
      "dependencies": ["DT-007", "DT-008"]
    },
    {
      "id": "DT-010",
      "title": "Note processing pipeline",
      "status": "backlog",
      "estimated_minutes": 30,
      "description": "Connect input ‚Üí classifier ‚Üí extractor ‚Üí refiner ‚Üí storage.",
      "acceptance_criteria": [
        "js/app.js exists",
        "Has processNote(rawText, inputType) function",
        "inputType is 'voice' or 'text'",
        "Flow: validate ‚Üí classify ‚Üí extract ‚Üí refine ‚Üí build note object ‚Üí save",
        "Note object matches FULL schema from CLAUDE.md section 6.2",
        "Includes machine_readable section with entities extracted from people",
        "Returns saved note with ID",
        "Empty/whitespace input shows error (doesn't save)",
        "Shows processing state in UI during save",
        "Shows success feedback after save",
        "Errors are caught and shown to user (doesn't crash)",
        "Updates recent notes on capture screen after save"
      ],
      "not_done_if": [
        "Empty input saves a note",
        "Note object missing required fields",
        "No UI feedback during/after processing",
        "Errors crash the app",
        "Missing machine_readable section"
      ],
      "verification": "cat js/app.js && echo 'Test: submit text, check note saved in IndexedDB'",
      "files_to_create": ["js/app.js"],
      "dependencies": ["DT-003", "DT-007", "DT-008", "DT-009"]
    },
    {
      "id": "DT-011",
      "title": "Notes list UI",
      "status": "backlog",
      "estimated_minutes": 45,
      "description": "Display saved notes with filtering following design from CLAUDE.md section 9.",
      "acceptance_criteria": [
        "Notes screen shows all notes from IndexedDB",
        "Notes grouped by date: TODAY, YESTERDAY, EARLIER (or actual dates)",
        "Each note card shows: title, category icon+label, time, preview (first 100 chars of summary)",
        "Note card styled per CLAUDE.md 9.2 (white bg, thin border, padding)",
        "Filter tabs at top: All, üíº Work, üè† Personal, üí™ Health, üí° Ideas",
        "Clicking filter shows only that category (All shows all)",
        "Active filter has visual indicator (underline or bold)",
        "Filters work instantly (no page reload)",
        "Empty state: 'No notes yet. Tap Capture to add your first note.'",
        "Notes sorted newest first",
        "Tapping note card opens detail view",
        "Search box at top filters notes by text in title/summary"
      ],
      "not_done_if": [
        "Filters don't work",
        "No empty state message",
        "Notes not sorted correctly",
        "Tapping note doesn't do anything",
        "Missing category icons"
      ],
      "verification": "Test in browser with multiple notes, test all filters",
      "files_to_create": [],
      "dependencies": ["DT-010"]
    },
    {
      "id": "DT-012",
      "title": "Note detail UI",
      "status": "backlog",
      "estimated_minutes": 30,
      "description": "Full note view showing refined output.",
      "acceptance_criteria": [
        "Note detail view (can be new screen or modal overlay)",
        "Back button/arrow to return to notes list",
        "Shows category icon and label at top",
        "Shows full title (large, bold)",
        "Shows full timestamp: day, date, time, timezone",
        "Shows refined.formatted_output rendered as formatted text",
        "Markdown rendered properly (headings, bullets, checkboxes)",
        "Copy to Clipboard button",
        "Export JSON button",
        "Delete button with confirmation dialog",
        "All buttons follow design system (black/white)",
        "Mobile responsive"
      ],
      "not_done_if": [
        "Can't get back to list",
        "Markdown not rendered",
        "Missing any button",
        "Delete has no confirmation"
      ],
      "verification": "Test: open note, verify all elements, test all buttons",
      "files_to_create": [],
      "dependencies": ["DT-011"]
    },
    {
      "id": "DT-013",
      "title": "Copy and export functionality",
      "status": "backlog",
      "estimated_minutes": 20,
      "description": "Implement clipboard and file export.",
      "acceptance_criteria": [
        "Copy button copies refined.formatted_output to clipboard",
        "Uses navigator.clipboard.writeText()",
        "Shows toast 'Copied!' for 1.5 seconds after copy",
        "Toast styled per CLAUDE.md 9.4 (black bg, white text, rounded)",
        "Export JSON button downloads single note as file",
        "Download filename: digital-twin-{id}.json",
        "Export All button in Settings exports entire database",
        "Export All filename: digital-twin-backup-{date}.json",
        "Exported JSON is pretty-printed (2-space indent)"
      ],
      "not_done_if": [
        "Copy doesn't work on mobile Safari",
        "No visual feedback on copy",
        "Export downloads invalid JSON",
        "Missing Export All in settings"
      ],
      "verification": "Test copy and export on desktop and mobile",
      "files_to_create": [],
      "dependencies": ["DT-012"]
    },
    {
      "id": "DT-014",
      "title": "PWA offline and install",
      "status": "backlog",
      "estimated_minutes": 30,
      "description": "Complete service worker and PWA features.",
      "acceptance_criteria": [
        "Service worker caches: index.html, styles.css, all js files, manifest, icons",
        "Cache name includes version number for updates",
        "Fetch handler serves from cache, falls back to network",
        "App works fully offline (can capture, save, view notes)",
        "Install prompt appears on supported browsers",
        "App is installable to home screen",
        "Installed app opens in standalone mode (no browser UI)",
        "Icons display correctly on home screen",
        "Settings screen shows app version",
        "Settings has 'Clear all data' button with confirmation"
      ],
      "not_done_if": [
        "App doesn't work offline",
        "Not installable",
        "Cache doesn't include all files",
        "Installed app shows browser UI"
      ],
      "verification": "Test: enable airplane mode, reload app, verify everything works",
      "files_to_create": [],
      "dependencies": ["DT-013"]
    }
  ]
}
